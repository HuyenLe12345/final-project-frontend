"use strict";(self.webpackChunkfront_end=self.webpackChunkfront_end||[]).push([[307],{307:()=>{},349:(e,s,t)=>{t.d(s,{A:()=>a});const a=function(e){return e?e.toLowerCase().replace("qu\u1ef9","quy").replace(/\s+/g,"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""):""}},646:()=>{},3519:(e,s,t)=>{t.d(s,{A:()=>c});var a=t(8139),r=t.n(a),l=t(5043),n=t(7852),i=t(579);const o=l.forwardRef(((e,s)=>{let{bsPrefix:t,fluid:a=!1,as:l="div",className:o,...c}=e;const d=(0,n.oU)(t,"container"),m="string"===typeof a?`-${a}`:"-fluid";return(0,i.jsx)(l,{ref:s,...c,className:r()(o,a?`${d}${m}`:d)})}));o.displayName="Container";const c=o},4234:(e,s,t)=>{t.d(s,{A:()=>se});var a=t(5043),r=t(3003),l=t(3519),n=t(1072),i=t(8602),o=t(8139),c=t.n(o),d=t(5173),m=t.n(d),u=t(579);const p={type:m().string,tooltip:m().bool,as:m().elementType},x=a.forwardRef(((e,s)=>{let{as:t="div",className:a,type:r="valid",tooltip:l=!1,...n}=e;return(0,u.jsx)(t,{...n,ref:s,className:c()(a,`${r}-${l?"tooltip":"feedback"}`)})}));x.displayName="Feedback",x.propTypes=p;const f=x,h=a.createContext({});var j=t(7852);const y=a.forwardRef(((e,s)=>{let{id:t,bsPrefix:r,className:l,type:n="checkbox",isValid:i=!1,isInvalid:o=!1,as:d="input",...m}=e;const{controlId:p}=(0,a.useContext)(h);return r=(0,j.oU)(r,"form-check-input"),(0,u.jsx)(d,{...m,ref:s,type:n,id:t||p,className:c()(l,r,i&&"is-valid",o&&"is-invalid")})}));y.displayName="FormCheckInput";const g=y,N=a.forwardRef(((e,s)=>{let{bsPrefix:t,className:r,htmlFor:l,...n}=e;const{controlId:i}=(0,a.useContext)(h);return t=(0,j.oU)(t,"form-check-label"),(0,u.jsx)("label",{...n,ref:s,htmlFor:l||i,className:c()(r,t)})}));N.displayName="FormCheckLabel";const v=N;const b=a.forwardRef(((e,s)=>{let{id:t,bsPrefix:r,bsSwitchPrefix:l,inline:n=!1,reverse:i=!1,disabled:o=!1,isValid:d=!1,isInvalid:m=!1,feedbackTooltip:p=!1,feedback:x,feedbackType:y,className:N,style:b,title:k="",type:w="checkbox",label:C,children:I,as:F="input",...$}=e;r=(0,j.oU)(r,"form-check"),l=(0,j.oU)(l,"form-switch");const{controlId:A}=(0,a.useContext)(h),R=(0,a.useMemo)((()=>({controlId:t||A})),[A,t]),S=!I&&null!=C&&!1!==C||function(e,s){return a.Children.toArray(e).some((e=>a.isValidElement(e)&&e.type===s))}(I,v),U=(0,u.jsx)(g,{...$,type:"switch"===w?"checkbox":w,ref:s,isValid:d,isInvalid:m,disabled:o,as:F});return(0,u.jsx)(h.Provider,{value:R,children:(0,u.jsx)("div",{style:b,className:c()(N,S&&r,n&&`${r}-inline`,i&&`${r}-reverse`,"switch"===w&&l),children:I||(0,u.jsxs)(u.Fragment,{children:[U,S&&(0,u.jsx)(v,{title:k,children:C}),x&&(0,u.jsx)(f,{type:y,tooltip:p,children:x})]})})})}));b.displayName="FormCheck";const k=Object.assign(b,{Input:g,Label:v});t(6440);const w=a.forwardRef(((e,s)=>{let{bsPrefix:t,type:r,size:l,htmlSize:n,id:i,className:o,isValid:d=!1,isInvalid:m=!1,plaintext:p,readOnly:x,as:f="input",...y}=e;const{controlId:g}=(0,a.useContext)(h);return t=(0,j.oU)(t,"form-control"),(0,u.jsx)(f,{...y,type:r,size:n,ref:s,readOnly:x,id:i||g,className:c()(o,p?`${t}-plaintext`:t,l&&`${t}-${l}`,"color"===r&&`${t}-color`,d&&"is-valid",m&&"is-invalid")})}));w.displayName="FormControl";const C=Object.assign(w,{Feedback:f}),I=a.forwardRef(((e,s)=>{let{className:t,bsPrefix:a,as:r="div",...l}=e;return a=(0,j.oU)(a,"form-floating"),(0,u.jsx)(r,{ref:s,className:c()(t,a),...l})}));I.displayName="FormFloating";const F=I,$=a.forwardRef(((e,s)=>{let{controlId:t,as:r="div",...l}=e;const n=(0,a.useMemo)((()=>({controlId:t})),[t]);return(0,u.jsx)(h.Provider,{value:n,children:(0,u.jsx)(r,{...l,ref:s})})}));$.displayName="FormGroup";const A=$,R=a.forwardRef(((e,s)=>{let{as:t="label",bsPrefix:r,column:l=!1,visuallyHidden:n=!1,className:o,htmlFor:d,...m}=e;const{controlId:p}=(0,a.useContext)(h);r=(0,j.oU)(r,"form-label");let x="col-form-label";"string"===typeof l&&(x=`${x} ${x}-${l}`);const f=c()(o,r,n&&"visually-hidden",l&&x);return d=d||p,l?(0,u.jsx)(i.A,{ref:s,as:"label",className:f,htmlFor:d,...m}):(0,u.jsx)(t,{ref:s,className:f,htmlFor:d,...m})}));R.displayName="FormLabel";const S=R,U=a.forwardRef(((e,s)=>{let{bsPrefix:t,className:r,id:l,...n}=e;const{controlId:i}=(0,a.useContext)(h);return t=(0,j.oU)(t,"form-range"),(0,u.jsx)("input",{...n,type:"range",ref:s,className:c()(r,t),id:l||i})}));U.displayName="FormRange";const L=U,P=a.forwardRef(((e,s)=>{let{bsPrefix:t,size:r,htmlSize:l,className:n,isValid:i=!1,isInvalid:o=!1,id:d,...m}=e;const{controlId:p}=(0,a.useContext)(h);return t=(0,j.oU)(t,"form-select"),(0,u.jsx)("select",{...m,size:l,ref:s,className:c()(n,t,r&&`${t}-${r}`,i&&"is-valid",o&&"is-invalid"),id:d||p})}));P.displayName="FormSelect";const T=P,_=a.forwardRef(((e,s)=>{let{bsPrefix:t,className:a,as:r="small",muted:l,...n}=e;return t=(0,j.oU)(t,"form-text"),(0,u.jsx)(r,{...n,ref:s,className:c()(a,t,l&&"text-muted")})}));_.displayName="FormText";const z=_,q=a.forwardRef(((e,s)=>(0,u.jsx)(k,{...e,ref:s,type:"switch"})));q.displayName="Switch";const D=Object.assign(q,{Input:k.Input,Label:k.Label}),O=a.forwardRef(((e,s)=>{let{bsPrefix:t,className:a,children:r,controlId:l,label:n,...i}=e;return t=(0,j.oU)(t,"form-floating"),(0,u.jsxs)(A,{ref:s,className:c()(a,t),controlId:l,...i,children:[r,(0,u.jsx)("label",{htmlFor:l,children:n})]})}));O.displayName="FloatingLabel";const V=O,G={_ref:m().any,validated:m().bool,as:m().elementType},M=a.forwardRef(((e,s)=>{let{className:t,validated:a,as:r="form",...l}=e;return(0,u.jsx)(r,{...l,ref:s,className:c()(t,a&&"was-validated")})}));M.displayName="Form",M.propTypes=G;const B=Object.assign(M,{Group:A,Control:C,Floating:F,Check:k,Switch:D,Label:S,Text:z,Range:L,Select:T,FloatingLabel:V});var E=t(8155),H=(t(8421),t(5304));const K={getComments:(e,s)=>{const t=`/projects/${e}/comments?contentType=${s}`;return H.A.get(t)},createComment:(e,s,t)=>{const a=`/projects/${e}/comments/create?contentType=${s}`;return H.A.post(a,t)},replyComment:(e,s,t)=>{const a=`/projects/${e}/comments/reply?contentType=${s}`;return H.A.post(a,t)},likeComment:e=>H.A.post("/projects/comments/like",e)};var W=t(3709),Y=t(3910),Z=t(7929),J=t(1148),Q=t(7198);const X=e=>{let{avatar:s,username:t,rows:a,parentId:r,idUser:l}=e;return(0,u.jsx)("fieldset",{children:(0,u.jsxs)(n.A,{className:"type-comment justify-content-start mb-0 ",children:[(0,u.jsx)(i.A,{className:"align-self-start",md:1,children:(0,u.jsx)(J.A,{avatar:s,username:t,href:"#"})}),(0,u.jsxs)(i.A,{xs:12,md:r?8:10,className:"message",children:[(0,u.jsx)(Q.A,{type:"textarea",id:"comment",placeholder:"Your message",name:"content",rows:a,className:"form-control",required:!0}),(0,u.jsx)("input",{type:"hidden",name:"senderId",value:l}),r&&(0,u.jsx)("input",{type:"hidden",name:"parentId",value:r})]}),r&&(0,u.jsx)("button",{type:"submit",className:"btn btn-success align-self-start col-md-1",children:"G\u1eedi"})]})})},ee=e=>{var s,t,a,r,l;let{comment:o,username:c,toggleLike:d,replyComment:m,className:p,clickReply:x,isReply:f,idUser:h,type:j}=e;console.log(f?`isReply ${f}`:o._id);const y=o.likes.some((e=>e.toString()===h.toString()));return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)(n.A,{className:`${p} ${f?"ms-1 me-2":""}`,children:[(0,u.jsx)(i.A,{className:"align-self-start",md:1,children:(0,u.jsx)(J.A,{avatar:null===(s=o.senderId)||void 0===s?void 0:s.avatar,username:(null===(t=o.senderId)||void 0===t?void 0:t.username)||(null===(a=o.senderId)||void 0===a?void 0:a.organizationName)})}),(0,u.jsxs)(i.A,{md:10,className:"media-body",children:[(0,u.jsx)("h6",{className:"media-heading",children:(null===(r=o.senderId)||void 0===r?void 0:r.username)||(null===(l=o.senderId)||void 0===l?void 0:l.organizationName)||"\u1ea8n danh"}),(0,u.jsx)("p",{children:o.content}),(0,u.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,u.jsx)("ul",{className:"d-flex list-unstyled list-inline media-detail pull-left",children:(0,u.jsxs)("li",{children:[(0,u.jsx)(Y.g,{icon:Z.l6G}),(0,u.jsx)("span",{children:" "}),new Date(o.createdAt).toLocaleString()]})}),(0,u.jsxs)("ul",{className:"d-flex list-unstyled list-inline media-detail pull-right "+(f?"me-3 ":""),children:[(0,u.jsxs)("li",{children:[(0,u.jsx)(Y.g,{icon:Z.Wcv}),(0,u.jsxs)("span",{children:[" ",o.likes.length]})]}),(0,u.jsx)("li",{className:"like",onClick:()=>d(o._id,h),children:(0,u.jsx)("a",{className:""+(y?"text-primary":""),children:y?"B\u1ecf th\xedch":"Th\xedch"})}),(0,u.jsx)("li",{className:"reply",onClick:()=>x(),children:(0,u.jsx)("a",{children:"Ph\u1ea3n h\u1ed3i"})})]})]})]})]})})},se=a.memo((e=>{let{type:s}=e;const t=(0,W.Zp)(),{contentId:o}=(0,W.g)();console.log(o);const c=(0,r.d4)((e=>e.user.avatar)),d=(0,r.d4)((e=>e.user.username)),m=(0,r.d4)((e=>e.user.idUser)),[p,x]=(0,a.useState)([]),[f,h]=(0,a.useState)(null);function j(e){h((s=>s===e?null:e))}async function y(){const e=await K.getComments(o,s);e&&!0===e.success?x(e.comments):!e||500!==e.status&&404!==e.status||t("/error-page",{state:{status:e.status,errors:e.errors}})}const g=async e=>{e.preventDefault();const a=new FormData(e.target),r=await K.replyComment(o,s,a);r&&!0===r.success?(y(),e.target.reset()):!r||500!==r.status&&404!==r.status||t("/error-page",{state:{status:r.status,errors:r.errors}})},N=(0,a.useCallback)((async(e,s)=>{const a=await K.likeComment({commentId:e,userId:s});a&&a.success?(console.log(a),x((t=>t.map((t=>{if(t.comment._id.toString()===e.toString())return{...t,comment:{...t.comment,likes:a.isLiked?[...t.comment.likes,s]:t.comment.likes.filter((e=>e.toString()!==s.toString()))}};const r=t.replies.map((t=>t._id.toString()===e.toString()?{...t,likes:a.isLiked?[...t.likes,s]:t.likes.filter((e=>e.toString()!==s.toString()))}:t));return{...t,replies:r}}))))):!a||500!==a.status&&404!==a.status||t("/error-page",{state:{status:a.status,errors:a.errors}})}),[s]);return(0,a.useEffect)((()=>{y()}),[o,s]),(0,u.jsx)("section",{id:"comments",className:"content-item ms-3 ps-4",children:(0,u.jsxs)(l.A,{children:[(0,u.jsx)(n.A,{children:(0,u.jsx)(i.A,{sm:8,md:12,children:(0,u.jsxs)(B,{method:"post",onSubmit:async e=>{e.preventDefault();const a=new FormData(e.target),r=await K.createComment(o,s,a);r&&!0===r.success?(y(),e.target.reset()):!r||500!==r.status&&404!==r.status||t("/error-page",{state:{status:r.status,errors:r.errors}})},children:[(0,u.jsx)("h3",{className:"pull-left",children:"B\xecnh lu\u1eadn m\u1edbi"}),(0,u.jsx)(E.A,{type:"submit",className:"btn btn-success pull-right",children:"G\u1eedi"}),(0,u.jsx)(X,{avatar:c,username:d,idUser:m,rows:"2",contentType:s})]})})}),0===p.length?(0,u.jsx)("h3",{children:"Kh\xf4ng c\xf3 b\xecnh lu\u1eadn n\xe0o."}):p.map((e=>(0,u.jsxs)("div",{style:{textAlign:"left"},children:[(0,u.jsx)(ee,{comment:e.comment,username:d,toggleLike:N,replyComment:g,clickReply:()=>j(e.comment._id),idUser:m,type:s}),e.replies.map((s=>{var t;return(0,u.jsx)(ee,{className:"message-reply justify-content-end",comment:s,username:null===(t=s.senderId)||void 0===t?void 0:t.username,toggleLike:N,clickReply:()=>j(e.comment._id),isReply:e.comment._id,idUser:m},s._id)})),f===e.comment._id&&(0,u.jsx)("div",{className:"row mb-0 justify-content-end",children:(0,u.jsx)(B,{className:"message-reply col-md-11 ps-4 me-1",onSubmit:g,children:(0,u.jsx)(X,{username:d,idUser:m,avatar:c,parentId:e.comment._id,rows:"1",contentType:s})})})]},e.comment._id)))]})})}))},6440:e=>{var s=function(){};e.exports=s},7198:(e,s,t)=>{t.d(s,{A:()=>r});t(5043),t(646);var a=t(579);const r=e=>{let{label:s,type:t,id:r,name:l,required:n,options:i,className:o,sharedName:c,value:d,disabled:m,onChange:u,rows:p,multiple:x,placeholder:f,min:h}=e;return console.log(n,l),(0,a.jsxs)("div",{className:`form-group ${c}`,children:[s&&"checkbox"!==t?(0,a.jsxs)("label",{htmlFor:r,children:[s,n?(0,a.jsx)("sup",{className:"text-danger",children:"*"}):""]}):null,"textarea"===t?(0,a.jsx)("textarea",{className:`form-control ${o}`,id:r,name:l,rows:p,value:d,onChange:u,placeholder:f,required:n}):"select"===t?(0,a.jsx)("select",{id:r,name:l,required:n,className:`form-control ${o}`,value:d,onChange:u,children:i.map(((e,s)=>(0,a.jsx)("option",{value:e.value,children:e.label},e.id?e.id:e.value||s)))}):"file"===t?(0,a.jsx)("input",{type:"file",id:r,name:l,multiple:x,required:n}):"text"===t||"number"===t||"date"===t||"email"===t||"password"===t?(0,a.jsx)("input",{className:`form-control ${o}`,type:t,id:r,name:l,value:d,onChange:u,min:h,disabled:m,placeholder:f,required:n}):"checkbox"===t?(0,a.jsxs)("div",{className:"checkbox-container",children:[(0,a.jsx)("input",{type:t,name:l,id:r,value:d,disabled:m}),(0,a.jsxs)("label",{htmlFor:r,children:[s,n?(0,a.jsx)("sup",{className:"text-danger",children:"*"}):""]})]}):null]})}},9652:(e,s,t)=>{t.d(s,{A:()=>r});t(307);var a=t(579);const r=e=>{let{children:s,formName:t,formTitle:r,errorMessage:l}=e;return(0,a.jsxs)("div",{className:`container-md  card ${t}`,children:[(0,a.jsx)("h5",{children:r}),l&&(0,a.jsxs)("p",{style:{color:"red",fontSize:"12px"},children:["*",l]}),s]})}}}]);
//# sourceMappingURL=307.c889de07.chunk.js.map